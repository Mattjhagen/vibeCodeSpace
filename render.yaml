# render.yaml: Configuration for deploying VibeCode on Render
# This file defines three services:
# 1. A PostgreSQL database for data persistence.
# 2. A Node.js Express backend service.
# 3. A React/Next.js frontend web service.

services:
  # -----------------
  # PostgreSQL Database
  # -----------------
  - type: psql
    name: vibecode-db
    # The 'plan' tier can be adjusted based on your needs (e.g., 'starter')
    plan: free
    # Render will automatically provision a database and inject its URL
    # into connected services.

  # -----------------
  # Web Service (Node.js/Express)
  # -----------------
  - type: web
    name: vibecode
    env: node
    # The region can be changed to be closer to your users
    region: oregon
    plan: free
    buildCommand: "npm install && npm run build && npm run build:backend"
    startCommand: "node dist/index.js"
    envVars:
      # The DATABASE_URL is automatically injected from the 'vibecode-db' service
      - key: DATABASE_URL
        fromDatabase:
          name: vibecode-db
          property: connectionString
      # Placeholders for Supabase credentials (if you use both)
      - key: SUPABASE_URL
        value: your_supabase_url
      - key: SUPABASE_KEY
        sync: false # Use 'sync: false' for sensitive keys
      # Placeholders for AI service keys
      - key: OPENAI_API_KEY
        sync: false
      - key: CLAUDE_API_KEY
        sync: false
      - key: GEMINI_API_KEY
        sync: false
